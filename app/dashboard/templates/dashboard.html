{% extends "base.html" %}
{% load static %}
{% block title %}Dashboard{% endblock %}
{% block css %}
<link rel="stylesheet" href={% static 'css/dashboard_style.css'%}>
{% endblock %}
{% block pre_js %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
{% endblock %}
{% block content %}
    <div id="errorPopup" class="popup hidden">
        <p id="errorMessage"></p>
    </div>

    <header>
        <h1>Sales | Dashboard</h1>
    </header>

    <div class="filters">
        <div class="filter-group">
            <div class="filter-item">
                <input type="text" id="periodFrom" placeholder="Data Início" onclick="changeType('periodFrom')">
            </div>
            <div class="filter-item">
                <input type="text" id="periodTo" placeholder="Data Fim" onclick="changeType('periodTo')">
            </div>
            <div class="filter-item">
                <select id="stateFilter">
                    <option value="">Estados</option>
                    <option value="AC">Acre</option>
                    <option value="AL">Alagoas</option>
                    <option value="AP">Amapá</option>
                    <option value="AM">Amazonas</option>
                    <option value="BA">Bahia</option>
                    <option value="CE">Ceará</option>
                    <option value="DF">Distrito Federal</option>
                    <option value="ES">Espírito Santo</option>
                    <option value="GO">Goiás</option>
                    <option value="MA">Maranhão</option>
                    <option value="MT">Mato Grosso</option>
                    <option value="MS">Mato Grosso do Sul</option>
                    <option value="MG">Minas Gerais</option>
                    <option value="PA">Pará</option>
                    <option value="PB">Paraíba</option>
                    <option value="PR">Paraná</option>
                    <option value="PE">Pernambuco</option>
                    <option value="PI">Piauí</option>
                    <option value="RJ">Rio de Janeiro</option>
                    <option value="RN">Rio Grande do Norte</option>
                    <option value="RS">Rio Grande do Sul</option>
                    <option value="RO">Rondônia</option>
                    <option value="RR">Roraima</option>
                    <option value="SC">Santa Catarina</option>
                    <option value="SP">São Paulo</option>
                    <option value="SE">Sergipe</option>
                    <option value="TO">Tocantins</option>
                </select>
            </div>
            <div class="filter-item">
                <select id="saleChannelFilter">
                    <option value="">Canal de Vendas</option>
                </select>
            </div>
            <div class="filter-item">
                <button onclick="fetchSalesData()" class="filter-button">Filtrar</button>
            </div>
        </div>
    </div>

    <div class="dashboard">
        <div class="kpi">
            <h3>Faturamento Total</h3>
            <br>
            <p id="totalPrice">R$ 00,00</p>
        </div>
        <div class="kpi">
            <h3>Lucro Total</h3>
            <br>
            <p id="totalProfit">R$ 00,00</p>
        </div>
        <div class="kpi">
            <h3>Quantidade de Vendas</h3>
            <p id="totalSales">0</p>
        </div>
    </div>

    <div class="chart-container">
        <h3>Top 3 Estados | Mais vendas</h3>
        <canvas id="salesByStateChart"></canvas>
    </div>
{% endblock %}
{% block pos_js %}
<script src={% static 'js/script.js' %}></script>
{% endblock %}